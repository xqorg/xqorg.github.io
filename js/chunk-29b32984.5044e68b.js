(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-29b32984"],{"7e8c":function(e,t,r){"use strict";r("cf73")},ac2a:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"main"},[t("a-form-model",{ref:"form",staticClass:"user-layout-login",attrs:{id:"formLogin",model:e.form,rules:e.rules}},[e.isLoginError?t("a-alert",{staticStyle:{"margin-bottom":"24px"},attrs:{type:"error",showIcon:"",message:e.loginErrorInfo,closable:"","after-close":e.handleCloseLoginError}}):e._e(),t("a-form-model-item",{attrs:{prop:"username"}},[t("a-input",{attrs:{size:"large",placeholder:e.$t("user.input.email")},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}},[t("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),t("a-form-model-item",{attrs:{prop:"password"}},[t("a-input-password",{attrs:{size:"large",placeholder:e.$t("user.input.pwd")},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}},[t("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),t("a-form-model-item",{attrs:{prop:"rememberMe"}},[t("a-checkbox",{attrs:{checked:e.form.rememberMe},on:{change:e.rememberMe}},[e._v(e._s(e.$t("user.remember.pwd")))])],1),t("a-form-item",{staticStyle:{"margin-top":"24px"}},[t("a-button",{staticClass:"login-button",attrs:{size:"large",type:"primary",htmlType:"submit",loading:e.logining,disabled:e.logining},on:{click:e.verificationCode}},[e._v(e._s(e.$t("user.login")))])],1),t("div",{staticClass:"oauth-login"},[t("a-button",{attrs:{block:"",loading:e.wechatLoading},on:{click:e.wechatLoginClick}},[e.wechatLoading?e._e():t("a-icon",{staticStyle:{"font-size":"17px",color:"#07C160","vertical-align":"-3px"},attrs:{type:"wechat"}}),e._v(" 微信扫码登录")],1)],1),t("div",{staticClass:"user-login-other"},[t("router-link",{staticClass:"resetPwd",attrs:{to:{name:"resetPwd"}}},[e._v(e._s(e.$t("user.forgot.password")))])],1),t("div",{staticClass:"user-login-other"},[t("router-link",{staticClass:"register",attrs:{to:{name:"register"}}},[e._v(e._s(e.$t("user.register")))])],1)],1),t("a-modal",{attrs:{maskClosable:!1,footer:null},model:{value:e.wechatVisible,callback:function(t){e.wechatVisible=t},expression:"wechatVisible"}},[t("template",{slot:"title"},[t("a-icon",{attrs:{type:"loading"}}),e._v(" 等待微信扫码... ")],1),t("div",{staticStyle:{"text-align":"center"}},[t("img",{attrs:{src:e.wechatQrcode,width:"200px"}})])],2),t("a-modal",{attrs:{maskClosable:!1,footer:null},model:{value:e.wechatRegVisible,callback:function(t){e.wechatRegVisible=t},expression:"wechatRegVisible"}},[t("template",{slot:"title"},[e._v("🔔 请选择你的操作 ")]),t("div",{staticStyle:{"text-align":"center",padding:"10px"}},[t("a-alert",{staticStyle:{"text-align":"left"},attrs:{message:"未绑定过神秘鸭！用此微信绑定已有账号还是注册新账号？（如果你已有账号建议进行绑定，以免邮箱被占用）",type:"info","show-icon":""}}),t("br"),t("br"),t("a-button",{attrs:{type:"primary",loading:e.wechatRegLoading},on:{click:e.registerWxHandle}},[e._v(" 登录并注册新账号 ")]),e._v("    "),t("a-button",{on:{click:e.bindWxLick}},[e._v("绑定已有账号")]),t("br"),t("br")],1)],2)],1)},a=[],o=r("5530"),s=(r("d3b7"),r("5880")),n=r("7ded"),c=r("9fb0"),l=r("8ded"),d=r.n(l),u={data:function(){return{timer:null,wechatVisible:!1,wechatRegVisible:!1,wechatLoading:!1,wechatRegLoading:!1,wechatQrcode:"",codeUrl:"",ticket:"",isLoginError:!1,loginErrorInfo:"",form:{username:"",password:"",ticket:void 0,randStr:"",rememberMe:!1},rules:{username:[{required:!0,message:this.$t("user.input.email"),trigger:"blur"}],password:[{required:!0,message:this.$t("user.input.pwd"),trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"}]},logining:!1,captchaEnabled:!0}},created:function(){this.getStorage()},methods:Object(o["a"])(Object(o["a"])({bindWxLick:function(){this.wechatRegVisible=!1,this.$info({title:"绑定提示",content:"你可以使用邮箱登录到后台，根据后台提示进行绑定微信！"})},registerWxHandle:function(){var e=this;this.wechatRegLoading=!0,Object(n["g"])({type:"register",ticket:this.ticket}).then((function(t){e.wechatRegLoading=!1,localStorage.setItem("access_token",t.msg),e.$router.push({path:"/index"})}))},checkQrcode:function(e){var t=this;Object(n["a"])(e).then((function(e){void 0!==e.data&&"0"!==e.data&&(clearInterval(t.timer),t.timer=null,Object(n["i"])({type:"login",ticket:e.data}).then((function(r){"needRegister"==r.data?(t.wechatLoading=!1,t.wechatVisible=!1,t.wechatRegVisible=!0,t.ticket=e.data):(localStorage.setItem("access_token",r.data),t.$router.push({path:"/index"}))})))})).catch((function(){clearInterval(t.timer),t.timer=null}))},verificationCode:function(){var e=this,t="2096394456",r=new TencentCaptcha(t,(function(t){0===t.ret&&(e.form.ticket=t.ticket,e.form.randStr=t.randstr,e.logining=!0,e.form.rememberMe?(d.a.set(c["g"],e.form.username),d.a.set(c["e"],e.form.password),d.a.set(c["f"],e.form.rememberMe)):(d.a.remove(c["g"]),d.a.remove(c["e"]),d.a.remove(c["f"])),e.Login(e.form).then((function(t){return e.loginSuccess(t)})).catch((function(t){return e.requestFailed(t)})).finally((function(){e.logining=!1})))}));r.langFun(),r.show()},wechatLoginClick:function(){var e=this;this.wechatLoading=!0,Object(n["c"])().then((function(t){if(200==t.code){e.wechatVisible=!0,e.wechatQrcode=t.data.qrCodeUrl;var r=t.data.key;e.timer=window.setInterval((function(){setTimeout(e.checkQrcode(r),0)}),1500)}})).finally((function(){e.wechatLoading=!1}))},getStorage:function(){var e=d.a.get(c["g"]),t=d.a.get(c["e"]),r=d.a.get(c["f"]);e&&(this.form={username:e,password:t,rememberMe:r})},rememberMe:function(e){this.form.rememberMe=e.target.checked}},Object(s["mapActions"])(["Login","Logout"])),{},{handleSubmit:function(){var e=this;this.$refs.form.validate((function(t){t&&e.$refs.verify.show()}))},loginSuccess:function(e){this.$router.push({path:"/"}),this.handleCloseLoginError()},requestFailed:function(e){this.isLoginError=!0,this.loginErrorInfo=e,this.form.code=void 0,this.captchaEnabled&&this.$refs.verify.show()},handleCloseLoginError:function(){this.isLoginError=!1,this.loginErrorInfo=""}})},g=u,m=(r("7e8c"),r("2877")),f=Object(m["a"])(g,i,a,!1,null,"cdae6572",null);t["default"]=f.exports},cf73:function(e,t,r){}}]);