(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-74ee7220","chunk-7c464ad6","chunk-6fcd23e8"],{"3eac":function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t._self._c;return e("page-header-wrapper",[e("a-card",{attrs:{bordered:!1}},[e("div",{staticClass:"table-page-search-wrapper"},[e("a-form",{attrs:{layout:"inline"}},[e("a-row",{attrs:{gutter:48}},[e("a-col",{attrs:{md:8,sm:24}},[e("a-form-item",{attrs:{label:"任务名称"}},[e("a-input",{attrs:{placeholder:"请输入任务名称","allow-clear":""},model:{value:t.queryParam.jobName,callback:function(e){t.$set(t.queryParam,"jobName",e)},expression:"queryParam.jobName"}})],1)],1),e("a-col",{attrs:{md:8,sm:24}},[e("a-form-item",{attrs:{label:"任务组名"}},[e("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择任务组名","allow-clear":""},model:{value:t.queryParam.jobGroup,callback:function(e){t.$set(t.queryParam,"jobGroup",e)},expression:"queryParam.jobGroup"}},t._l(t.dict.type["sys_job_group"],(function(o,a){return e("a-select-option",{key:a,attrs:{value:o.value}},[t._v(t._s(o.label))])})),1)],1)],1),t.advanced?[e("a-col",{attrs:{md:8,sm:24}},[e("a-form-item",{attrs:{label:"任务状态"}},[e("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择任务状态","allow-clear":""},model:{value:t.queryParam.status,callback:function(e){t.$set(t.queryParam,"status",e)},expression:"queryParam.status"}},t._l(t.dict.type["sys_job_status"],(function(o,a){return e("a-select-option",{key:a,attrs:{value:o.value}},[t._v(t._s(o.label))])})),1)],1)],1)]:t._e(),e("a-col",{attrs:{md:t.advanced?24:8,sm:24}},[e("span",{staticClass:"table-page-search-submitButtons",style:t.advanced&&{float:"right",overflow:"hidden"}||{}},[e("a-button",{attrs:{type:"primary"},on:{click:t.handleQuery}},[e("a-icon",{attrs:{type:"search"}}),t._v("查询")],1),e("a-button",{staticStyle:{"margin-left":"8px"},on:{click:t.resetQuery}},[e("a-icon",{attrs:{type:"redo"}}),t._v("重置")],1),e("a",{staticStyle:{"margin-left":"8px"},on:{click:t.toggleAdvanced}},[t._v(" "+t._s(t.advanced?"收起":"展开")+" "),e("a-icon",{attrs:{type:t.advanced?"up":"down"}})],1)],1)])],2)],1)],1),e("div",{staticClass:"table-operations"},[e("a-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["monitor:job:add"],expression:"['monitor:job:add']"}],attrs:{type:"primary"},on:{click:function(e){return t.$refs.createForm.handleAdd()}}},[e("a-icon",{attrs:{type:"plus"}}),t._v("新增 ")],1),e("a-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["monitor:job:edit"],expression:"['monitor:job:edit']"}],attrs:{type:"primary",disabled:t.single},on:{click:function(e){return t.$refs.createForm.handleUpdate(void 0,t.ids)}}},[e("a-icon",{attrs:{type:"edit"}}),t._v("修改 ")],1),e("a-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["monitor:job:remove"],expression:"['monitor:job:remove']"}],attrs:{type:"danger",disabled:t.multiple},on:{click:t.handleDelete}},[e("a-icon",{attrs:{type:"delete"}}),t._v("删除 ")],1),e("a-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["monitor:job:export"],expression:"['monitor:job:export']"}],attrs:{type:"primary"},on:{click:t.handleExport}},[e("a-icon",{attrs:{type:"download"}}),t._v("导出 ")],1),e("a-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["monitor:job:query"],expression:"['monitor:job:query']"}],attrs:{type:"dashed"},on:{click:t.handleJobLog}},[e("a-icon",{attrs:{type:"snippets"}}),t._v("日志 ")],1),e("table-setting",{style:{float:"right"},attrs:{"table-size":t.tableSize,"refresh-loading":t.loading},on:{"update:tableSize":function(e){t.tableSize=e},"update:table-size":function(e){t.tableSize=e},refresh:t.getList},model:{value:t.columns,callback:function(e){t.columns=e},expression:"columns"}})],1),e("view-form",{ref:"viewForm",attrs:{jobGroupOptions:t.dict.type["sys_job_group"]}}),e("create-form",{ref:"createForm",attrs:{statusOptions:t.dict.type["sys_job_status"],jobGroupOptions:t.dict.type["sys_job_group"]},on:{ok:t.getList}}),e("a-table",{attrs:{loading:t.loading,size:t.tableSize,rowKey:"jobId",columns:t.columns,"data-source":t.list,"row-selection":{selectedRowKeys:t.selectedRowKeys,onChange:t.onSelectChange},pagination:!1,bordered:t.tableBordered},scopedSlots:t._u([{key:"jobGroup",fn:function(o,a){return e("span",{},[e("dict-tag",{attrs:{options:t.dict.type["sys_job_group"],value:a.jobGroup}})],1)}},{key:"status",fn:function(o,a){return e("span",{},[e("a-popconfirm",{attrs:{"ok-text":"是","cancel-text":"否"},on:{confirm:function(e){return t.confirmHandleStatus(a)},cancel:function(e){return t.cancelHandleStatus(a)}}},[e("span",{attrs:{slot:"title"},slot:"title"},[t._v("确认"),e("b",[t._v(t._s("1"===a.status?"开启":"关闭"))]),t._v(t._s(a.jobName)+"的任务吗?")]),e("a-switch",{attrs:{"checked-children":"开","un-checked-children":"关",checked:0==a.status}})],1)],1)}},{key:"operation",fn:function(o,a){return e("span",{},[e("a",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["monitor:job:edit"],expression:"['monitor:job:edit']"}],on:{click:function(e){return t.$refs.createForm.handleUpdate(a,void 0)}}},[e("a-icon",{attrs:{type:"edit"}}),t._v(" 修改 ")],1),e("a-divider",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["monitor:job:remove"],expression:"['monitor:job:remove']"}],attrs:{type:"vertical"}}),e("a",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["monitor:job:remove"],expression:"['monitor:job:remove']"}],on:{click:function(e){return t.handleDelete(a)}}},[e("a-icon",{attrs:{type:"delete"}}),t._v(" 删除 ")],1),e("a-divider",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:job:edit","monitor:job:query"],expression:"['system:job:edit', 'monitor:job:query']"}],attrs:{type:"vertical"}}),e("a-dropdown",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:job:edit","monitor:job:query"],expression:"['system:job:edit', 'monitor:job:query']"}]},[e("a",{staticClass:"ant-dropdown-link",on:{click:function(t){return t.preventDefault()}}},[e("a-icon",{attrs:{type:"double-right"}}),t._v(" 更多 ")],1),e("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[e("a-menu-item",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["monitor:job:edit"],expression:"['monitor:job:edit']"}]},[e("a-popconfirm",{attrs:{"ok-text":"是","cancel-text":"否"},on:{confirm:function(e){return t.confirmHandleRun(a)},cancel:function(e){return t.cancelHandleRun(a)}}},[e("span",{attrs:{slot:"title"},slot:"title"},[t._v("确认执行一次"+t._s(a.jobName)+"的任务吗?")]),e("a",[e("a-icon",{attrs:{type:"caret-right"}}),t._v(" 执行一次 ")],1)])],1),e("a-menu-item",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["monitor:job:query"],expression:"['monitor:job:query']"}]},[e("a",{on:{click:function(e){return t.$refs.viewForm.handleView(a)}}},[e("a-icon",{attrs:{type:"eye"}}),t._v(" 详细 ")],1)])],1)],1)],1)}}])}),e("a-pagination",{staticClass:"ant-table-pagination",attrs:{"show-size-changer":"","show-quick-jumper":"",current:t.queryParam.pageNum,total:t.total,"page-size":t.queryParam.pageSize,showTotal:function(t){return"共 ".concat(t," 条")}},on:{showSizeChange:t.onShowSizeChange,change:t.changeSize}})],1)],1)},r=[],n=o("5530"),i=(o("d81d"),o("a159")),s=o("4da9"),l=o("bad6"),c=o("435a"),u={name:"Job",components:{CreateForm:s["default"],ViewForm:l["default"]},mixins:[c["a"]],dicts:["sys_job_group","sys_job_status"],data:function(){return{list:[],selectedRowKeys:[],selectedRows:[],advanced:!1,single:!0,multiple:!0,ids:[],loading:!1,total:0,dateRange:[],queryParam:{pageNum:1,pageSize:10,jobName:void 0,jobGroup:void 0,status:void 0},columns:[{title:"任务编号",dataIndex:"jobId",align:"center"},{title:"任务名称",dataIndex:"jobName",ellipsis:!0,align:"center"},{title:"任务组名",dataIndex:"jobGroup",scopedSlots:{customRender:"jobGroup"},align:"center"},{title:"调用目标字符串",dataIndex:"invokeTarget",ellipsis:!0,align:"center"},{title:"cron执行表达式",dataIndex:"cronExpression",ellipsis:!0,align:"center"},{title:"状态",dataIndex:"status",scopedSlots:{customRender:"status"},align:"center"},{title:"操作",dataIndex:"operation",width:"15%",scopedSlots:{customRender:"operation"},align:"center"}]}},filters:{},created:function(){this.getList()},computed:{},watch:{},methods:{getList:function(){var t=this;this.loading=!0,Object(i["e"])(this.queryParam).then((function(e){t.list=e.rows,t.total=e.total,t.loading=!1}))},handleQuery:function(){this.queryParam.pageNum=1,this.getList()},resetQuery:function(){this.dateRange=[],this.queryParam={pageNum:1,pageSize:10,jobName:void 0,jobGroup:void 0,status:void 0},this.handleQuery()},onShowSizeChange:function(t,e){this.queryParam.pageSize=e,this.getList()},changeSize:function(t,e){this.queryParam.pageNum=t,this.queryParam.pageSize=e,this.getList()},onSelectChange:function(t,e){this.selectedRowKeys=t,this.selectedRows=e,this.ids=this.selectedRows.map((function(t){return t.jobId})),this.single=1!==t.length,this.multiple=!t.length},toggleAdvanced:function(){this.advanced=!this.advanced},handleJobLog:function(){this.$router.push({path:"/monitor/job/log"})},confirmHandleStatus:function(t){var e=this,o="1"===t.status?"启用":"停用";t.status="0"===t.status?"1":"0",Object(i["b"])(t.jobId,t.status).then((function(){e.$message.success(o+"成功",3)})).catch((function(){this.$message.error(o+"发生异常",3)}))},cancelHandleStatus:function(t){},confirmHandleRun:function(t){var e=this;Object(i["f"])(t.jobId,t.jobGroup).then((function(){e.$message.success("执行成功",3)})).catch((function(){this.$message.error("发生异常",3)}))},cancelHandleRun:function(t){},handleDelete:function(t){var e=this;this.ids=this.selectedRows.map((function(t){return t.jobId}));var o=t.jobId||this.ids;this.$confirm({title:"确认删除所选中数据?",content:"当前选中定时任务编号为"+o+"的数据",onOk:function(){return Object(i["c"])(o).then((function(){e.onSelectChange([],[]),e.getList(),e.$message.success("删除成功",3)}))},onCancel:function(){}})},handleExport:function(){var t=this;this.$confirm({title:"是否确认导出?",content:"此操作将导出当前条件下所有数据而非选中数据",onOk:function(){t.download("monitor/job/export",Object(n["a"])({},t.queryParam),"job_".concat((new Date).getTime(),".xlsx"))},onCancel:function(){}})}}},d=u,m=o("2877"),p=Object(m["a"])(d,a,r,!1,null,null,null);e["default"]=p.exports},"4da9":function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t._self._c;return e("a-drawer",{attrs:{width:"35%","label-col":4,"wrapper-col":14,visible:t.open},on:{close:t.onClose}},[e("a-divider",{attrs:{orientation:"left"}},[e("b",[t._v(t._s(t.formTitle))])]),e("a-form-model",{ref:"form",attrs:{model:t.form,rules:t.rules}},[e("a-form-model-item",{attrs:{label:"任务名称",prop:"jobName"}},[e("a-input",{attrs:{placeholder:"请输入任务名称"},model:{value:t.form.jobName,callback:function(e){t.$set(t.form,"jobName",e)},expression:"form.jobName"}})],1),e("a-form-model-item",{attrs:{label:"任务分组",prop:"jobGroup"}},[e("a-select",{attrs:{placeholder:"请选择"},model:{value:t.form.jobGroup,callback:function(e){t.$set(t.form,"jobGroup",e)},expression:"form.jobGroup"}},t._l(t.jobGroupOptions,(function(o,a){return e("a-select-option",{key:a,attrs:{value:o.value}},[t._v(t._s(o.label))])})),1)],1),e("a-form-model-item",{attrs:{prop:"invokeTarget"}},[e("span",{attrs:{slot:"label"},slot:"label"},[t._v(" 调用方法  "),e("a-popover",{attrs:{placement:"topLeft"}},[e("template",{slot:"content"},[e("p",[t._v("Class类调用示例："),e("code",[t._v("com.ruoyi.quartz.task.RyTask.ryParams('ry')")])]),e("p",[t._v("参数说明：支持字符串，布尔类型，长整型，浮点型，整型")])]),e("span",{attrs:{slot:"title"},slot:"title"},[t._v(" Bean调用示例："),e("code",[t._v("ryTask.ryParams('ry')")])]),e("a-icon",{attrs:{type:"question-circle-o"}})],2)],1),e("a-input",{attrs:{placeholder:"请输入调用目标字符串"},model:{value:t.form.invokeTarget,callback:function(e){t.$set(t.form,"invokeTarget",e)},expression:"form.invokeTarget"}})],1),e("a-form-model-item",{attrs:{label:"cron表达式",prop:"cronExpression"}},[e("a-input-search",{attrs:{placeholder:"请输入cron执行表达式"},on:{search:function(e){return t.$refs.genCrontab.show(t.form.cronExpression)}},model:{value:t.form.cronExpression,callback:function(e){t.$set(t.form,"cronExpression",e)},expression:"form.cronExpression"}},[e("a-button",{attrs:{slot:"enterButton"},slot:"enterButton"},[t._v(" 生成表达式 "),e("a-icon",{attrs:{type:"tool"}})],1)],1)],1),e("a-form-model-item",{attrs:{label:"是否并发",prop:"concurrent"}},[e("a-radio-group",{attrs:{"button-style":"solid"},model:{value:t.form.concurrent,callback:function(e){t.$set(t.form,"concurrent",e)},expression:"form.concurrent"}},[e("a-radio-button",{attrs:{value:"0"}},[t._v("允许")]),e("a-radio-button",{attrs:{value:"1"}},[t._v("禁止")])],1)],1),e("a-form-model-item",{attrs:{label:"错误策略",prop:"misfirePolicy"}},[e("a-radio-group",{attrs:{"button-style":"solid"},model:{value:t.form.misfirePolicy,callback:function(e){t.$set(t.form,"misfirePolicy",e)},expression:"form.misfirePolicy"}},[e("a-radio-button",{attrs:{value:"1"}},[t._v("立即执行")]),e("a-radio-button",{attrs:{value:"2"}},[t._v("执行一次")]),e("a-radio-button",{attrs:{value:"3"}},[t._v("放弃执行")])],1)],1),e("a-form-model-item",{attrs:{label:"状态",prop:"status"}},[e("a-radio-group",{attrs:{"button-style":"solid"},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},t._l(t.statusOptions,(function(o,a){return e("a-radio",{key:a,attrs:{value:o.value}},[t._v(t._s(o.label))])})),1)],1),e("div",{staticClass:"bottom-control"},[e("a-space",[e("a-button",{attrs:{type:"primary",loading:t.submitLoading},on:{click:t.submitForm}},[t._v(" 保存 ")]),e("a-button",{attrs:{type:"dashed"},on:{click:t.cancel}},[t._v(" 取消 ")])],1)],1)],1),e("gen-crontab",{ref:"genCrontab",on:{fill:t.crontabFill}})],1)},r=[],n=(o("d3b7"),o("a159")),i=o("f582"),s={name:"CreateForm",components:{GenCrontab:i["default"]},props:{statusOptions:{type:Array,required:!0},jobGroupOptions:{type:Array,required:!0}},data:function(){return{submitLoading:!1,formTitle:"",form:{jobId:void 0,jobName:void 0,jobGroup:void 0,invokeTarget:void 0,cronExpression:void 0,misfirePolicy:"1",concurrent:"1",status:"0"},open:!1,openView:!1,rules:{jobName:[{required:!0,message:"任务名称不能为空",trigger:"blur"}],invokeTarget:[{required:!0,message:"调用目标字符串不能为空",trigger:"blur"}],cronExpression:[{required:!0,message:"cron执行表达式不能为空",trigger:"blur"}]}}},filters:{},created:function(){},computed:{},watch:{},methods:{handleView:function(t){var e=this;Object(n["d"])(t.jobId).then((function(t){e.form=t.data,e.openView=!0}))},onCloseView:function(){this.openView=!1},onClose:function(){this.open=!1},cancel:function(){this.open=!1,this.reset()},reset:function(){this.form={jobId:void 0,jobName:void 0,jobGroup:void 0,invokeTarget:void 0,cronExpression:void 0,misfirePolicy:"1",concurrent:"1",status:"0"}},handleAdd:function(){this.reset(),this.open=!0,this.formTitle="添加任务"},handleUpdate:function(t,e){var o=this;this.reset();var a=t?t.jobId:e;Object(n["d"])(a).then((function(t){o.form=t.data,o.open=!0,o.formTitle="修改任务"}))},submitForm:function(){var t=this;this.$refs.form.validate((function(e){if(!e)return!1;t.submitLoading=!0,void 0!==t.form.jobId?Object(n["g"])(t.form).then((function(e){t.$message.success("修改成功",3),t.open=!1,t.$emit("ok")})).finally((function(){t.submitLoading=!1})):Object(n["a"])(t.form).then((function(e){t.$message.success("新增成功",3),t.open=!1,t.$emit("ok")})).finally((function(){t.submitLoading=!1}))}))},crontabFill:function(t){this.form.cronExpression=t}}},l=s,c=o("2877"),u=Object(c["a"])(l,a,r,!1,null,null,null);e["default"]=u.exports},a159:function(t,e,o){"use strict";o.d(e,"e",(function(){return r})),o.d(e,"d",(function(){return n})),o.d(e,"a",(function(){return i})),o.d(e,"g",(function(){return s})),o.d(e,"c",(function(){return l})),o.d(e,"b",(function(){return c})),o.d(e,"f",(function(){return u}));var a=o("b775");function r(t){return Object(a["b"])({url:"/monitor/job/list",method:"get",params:t})}function n(t){return Object(a["b"])({url:"/monitor/job/"+t,method:"get"})}function i(t){return Object(a["b"])({url:"/monitor/job",method:"post",data:t})}function s(t){return Object(a["b"])({url:"/monitor/job",method:"put",data:t})}function l(t){return Object(a["b"])({url:"/monitor/job/"+t,method:"delete"})}function c(t,e){var o={jobId:t,status:e};return Object(a["b"])({url:"/monitor/job/changeStatus",method:"put",data:o})}function u(t,e){var o={jobId:t,jobGroup:e};return Object(a["b"])({url:"/monitor/job/run",method:"put",data:o})}},bad6:function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t._self._c;return e("a-drawer",{attrs:{width:"35%",placement:"right",closable:!1,visible:t.openView},on:{close:t.onCloseView}},[e("a-descriptions",{attrs:{title:"任务详细",layout:"vertical",bordered:""}},[e("a-descriptions-item",{attrs:{label:"任务编号"}},[t._v(" "+t._s(t.form.jobId)+" ")]),e("a-descriptions-item",{attrs:{label:"任务分组"}},[e("dict-tag",{attrs:{options:t.jobGroupOptions,value:t.form.jobGroup}})],1),e("a-descriptions-item",{attrs:{label:"任务名称"}},[t._v(" "+t._s(t.form.jobName)+" ")]),e("a-descriptions-item",{attrs:{label:"创建时间"}},[t._v(" "+t._s(t.form.createTime)+" ")]),e("a-descriptions-item",{attrs:{label:"下次执行时间",span:"2"}},[t._v(" "+t._s(t.parseTime(t.form.nextValidTime))+" ")]),e("a-descriptions-item",{attrs:{label:"调用目标方法"}},[t._v(" "+t._s(t.form.invokeTarget)+" ")]),e("a-descriptions-item",{attrs:{label:"cron表达式",span:"2"}},[t._v(" "+t._s(t.form.cronExpression)+" ")]),e("a-descriptions-item",{attrs:{label:"任务状态"}},[0==t.form.status?e("a-badge",{attrs:{status:"processing",text:"运行中"}}):t._e(),1==t.form.status?e("a-badge",{attrs:{status:"warning",text:"暂停"}}):t._e()],1),e("a-descriptions-item",{attrs:{label:"是否并发"}},[0==t.form.concurrent?e("a-badge",{attrs:{status:"processing",text:"允许"}}):t._e(),1==t.form.concurrent?e("a-badge",{attrs:{status:"warning",text:"禁止"}}):t._e()],1),e("a-descriptions-item",{attrs:{label:"执行策略"}},[0==t.form.misfirePolicy?e("a-badge",{attrs:{status:"default",text:"默认策略"}}):t._e(),1==t.form.misfirePolicy?e("a-badge",{attrs:{status:"Processing",text:"立即执行"}}):t._e(),2==t.form.misfirePolicy?e("a-badge",{attrs:{color:"purple",text:"执行一次"}}):t._e(),3==t.form.misfirePolicy?e("a-badge",{attrs:{status:"warning",text:"放弃执行"}}):t._e()],1)],1)],1)},r=[],n=o("a159"),i={name:"ViewForm",props:{jobGroupOptions:{type:Array,required:!0}},data:function(){return{loading:!1,formTitle:"",form:{jobId:void 0,jobName:void 0,jobGroup:void 0,invokeTarget:void 0,cronExpression:void 0,misfirePolicy:"1",concurrent:"1",status:"0"},openView:!1}},filters:{},created:function(){},computed:{},watch:{},methods:{handleView:function(t){var e=this;Object(n["d"])(t.jobId).then((function(t){e.form=t.data,e.openView=!0}))},onCloseView:function(){this.openView=!1}}},s=i,l=o("2877"),c=Object(l["a"])(s,a,r,!1,null,null,null);e["default"]=c.exports}}]);